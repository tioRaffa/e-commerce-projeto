from django import forms
from django.core.mail.message import EmailMessage


!!!!!!!!!!! NO HTML POSSO USAR A TAG 'NAME' PARA CAPTURAR O NOME QUE ESTA NO FORMS




class ContactForms(forms.Form):
    name = forms.CharField(max_length=20, label='Name')
    email = forms.EmailField(max_length=100, label='E-mail')
    subject = forms.CharField(max_length=100, label='Subject')
    message = forms.CharField(
        max_length=100, widget=forms.Textarea(), label='Message')
    
    def send_email(self):
        name = self.cleaned_data['name']
        email = self.cleaned_data['email']
        subject = self.cleaned_data['subject']
        message = self.cleaned_data['message']
        
        content = f'Nome: {name}\nE-mail: {email}\nSubject: {subject}\nMessage: {message}'
        
        success = f'\033[31mE-mail sent succescfully!\033[m'
        
        mail = EmailMessage(
            subject=success,
            body=content,
            from_email='contato@seudominio.com.br',
            to=['contato@seudominio.com.br'],
            headers={'Reply-To': email}
        )
        
        mail.send()

#

    views.py:
        importar o modulo do forms
(opc)   from django.contrib import messages

        dentro da funcao:
                form = ContactForms(request.POST or None)
    
                if str(request.method) == 'POST':
                    if form.is_valid():
                        form.send_email()
                                |-> funcao da classe           

opcional(dentro do if): messages.success(request, 'E-mail enviado com sucesso')
                        form = ContactForms()
                    else:
                        messages.error(request, 'Erro ao enviar o E-mail!')


    html:
        {% extends "global/base.html" %}
!!!     {% load bootstrap4 %}

!!!     {% block links %}{% bootstrap_css %}{% endblock links %}

        {% block title %}Contact{% endblock title %}

        {% block content %}
            <div class="container">
                <h1>Contato</h1>
                
                <form action="{% url 'contact' %}" method="post" class="form" autocomplete="off">
                    {% csrf_token %}

!!!                 {% bootstrap_form form_vws %}
                                        \|/ -> context passado na views.py

!!!                 {% bootstrap_messages %}

                    {% buttons %}
                        <button type="submit" class="btn btn-primary">Enviar Mensagem</button>
                    {% endbuttons %}

                </form>
            </div>

!!!     {% bootstrap_javascript jquery='full' %}
        {% endblock content %}


#   Settings.py E-mail:
    EMAIL_BACKEND = 'django.core.mail.backends.console.EmailBackend'